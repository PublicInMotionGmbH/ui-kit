@import './config'

$base-color: #e9ecef
$stripes-color: rgba(255, 255, 255, .15)
$progress-height: dp(2)
$stripes-scale: 2
$indeterminate-stripes-scale: 8
$error-color: #f01414 // or $color-talixo-error-red?
$stripes-movement-time: 0.1s
$border-radius: 2px

@mixin progress-bar-color ($type, $color)
  @include module('progress-bar')
    &--#{$type}
      background: mix($base-color, $color, 85%)

    &--#{$type} &__inner
      background: $color

@mixin progress-bar-height ($type, $height)
  @include module('progress-bar')
    &--#{$type}
      height: $height

@include module('progress-bar')
  display: block
  height: $progress-height
  background: $base-color
  border-radius: $border-radius
  overflow: hidden

  &__inner
    position: relative
    height: 100%
    background: #ddd
    min-width: 3px

  &--striped &__inner:after,
  &--indeterminate &__inner:after
    content: ''
    position: absolute
    left: 0
    top: 0
    right: 0
    bottom: 0
    user-select: none
    pointer-events: none
    background-size: #{$progress-height * $stripes-scale} #{$progress-height * $stripes-scale}
    background-repeat: repeat
    background-image: linear-gradient(45deg, $stripes-color 25%, transparent 0, transparent 50%, $stripes-color 0, $stripes-color 75%, transparent 0, transparent)

  &--indeterminate &__inner
    width: 100%
    transform: none
    animation: none

    &:after
      background-size: #{$progress-height * $indeterminate-stripes-scale} #{$progress-height * $indeterminate-stripes-scale}
      animation: #{$stripes-movement-time * $indeterminate-stripes-scale} unknownProgressStripes infinite linear

  &--smooth &__inner
    transition: 400ms width linear

  &--sticky-top,
  &--sticky-bottom
    position: absolute
    left: 0
    right: 0

  &--sticky-top
    bottom: 100%
    margin-bottom: -1px
    border-radius: $border-radius $border-radius 0 0

  &--sticky-bottom
    top: 100%
    margin-top: -1px
    border-radius: 0 0 $border-radius $border-radius

@include progress-bar-color('error', $error-color)
@include progress-bar-color('success', $color-talixo-success-green)
@include progress-bar-color('info', $color-pill-blue)
@include progress-bar-color('warning', $color-talixo-warning-yellow)

@include progress-bar-height('small', dp(1.25))

@keyframes unknownProgressStripes
  0%
    background-position: 0 0
  100%
    background-position: #{$progress-height * $indeterminate-stripes-scale} 0
